(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[825],{8810:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[locale]/admin",function(){return a(47578)}])},93607:function(e,t,a){"use strict";var r=a(85893);a(67294);var s=a(99200),l=a(43472),n=a(94184),i=a.n(n);let d=e=>{let{field:t,fieldLabel:a,placeholder:n,errors:d,touched:o,required:c}=e;return(0,r.jsxs)(s.cw,{row:!0,children:[(0,r.jsxs)(s.__,{for:t,lg:2,children:[a,c&&(0,r.jsx)("span",{className:"required-asterisk",children:"*"})]}),(0,r.jsxs)(s.JX,{lg:10,children:[(0,r.jsx)(s.BZ,{children:(0,r.jsx)(s.II,{type:"tel",name:t,id:t,tag:l.gN,required:!0,className:i()({"is-invalid":o[t]&&d[t]}),placeholder:n||"Type here..."})}),(0,r.jsx)(l.Bc,{name:t,render:e=>(0,r.jsx)("small",{className:"text-danger",children:e})})]})]})};t.Z=d},70297:function(e,t,a){"use strict";var r=a(85893);a(67294);var s=a(99200),l=a(43472),n=a(94184),i=a.n(n);let d=e=>{let{field:t,fieldLabel:a,placeholder:n,errors:d,touched:o,required:c}=e;return(0,r.jsxs)(s.cw,{row:!0,children:[(0,r.jsxs)(s.__,{for:t,lg:2,children:[a,c&&(0,r.jsx)("span",{className:"required-asterisk",children:"*"})]}),(0,r.jsxs)(s.JX,{lg:10,children:[(0,r.jsx)(s.BZ,{children:(0,r.jsx)(s.II,{type:"text",name:t,id:t,tag:l.gN,required:!0,className:i()({"is-invalid":o[t]&&d[t]}),placeholder:n||"Type here..."})}),(0,r.jsx)(l.Bc,{name:t,render:e=>(0,r.jsx)("small",{className:"text-danger",children:e})})]})]})};t.Z=d},47578:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSG:function(){return ei},default:function(){return ed}});var r=a(85893),s=a(67294),l=a(11163),n=a(13125),i=a(99010),d=a(99200),o=a(42763),c=a(96827),h=a(74201),u=a(49474),m=a(35337),_=a(584),x=a(20466),p=a(77349),f=a(7069),g=a(21593),v=a(54559),j=a(90811),b=a(10041),y=a(313),Z=a(42699),N=a(95826),w=a(20784);let k=[4,5,6,7,8,9],q=[2,4];var S=a(96843),D=a(61973);a.e(775).then(a.t.bind(a,36775,23));let E=e=>{let{events:t,daysSelected:a,setDaysSelected:n,type:i,setTooManyDaysError:E}=e,{query:I}=(0,l.useRouter)(),{t:M}=(0,o.$G)("reservations"),[B,C]=(0,s.useState)(),[z,R]=(0,s.useState)(4),{messages:L,formats:X}=(0,s.useMemo)(()=>({messages:{previous:M("previous"),next:M("next"),today:M("today")},formats:{monthHeaderFormat:(e,t,a)=>{let r=a.format(e,"MMMM yyyy",t);return r.charAt(0).toUpperCase()+r.slice(1)}}}),[]);(0,s.useEffect)(()=>{R(i.days)},[i]),(0,s.useEffect)(()=>{let e=new Date;C(e),k.includes(e.getMonth())?C(e):C(new Date("".concat(e.getFullYear(),"-05-15")))},[]);let O=e=>{let t=e.event,a=0;return t.reservations.forEach(e=>a+=e.customer_forms.length),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:"en"===I.locale?t.title_en:t.title_fr}),(0,r.jsx)("div",{children:(0,y.Z)(e.start,(0,f.Z)(new Date,1))?M("event_finished"):M("places_left",{places_left:t.max_reservations-a})})]})},{components:F}=(0,s.useMemo)(()=>({components:{event:O}}),[]),A={en:N.Z,fr:w.Z},H=(0,c.lD)({format:h.Z,parse:m.Z,startOfWeek:()=>(0,_.Z)(new Date,{weekStartsOn:1}),getDay:x.Z,locales:A}),J=e=>{let r=[e.slots[0]];if(!k.includes(r[0].getMonth())||(0,y.Z)(r[0],(0,f.Z)(new Date,1)))return null;let s=t.filter(e=>{let t=r[0];return(0,b.Z)(t)&&(t=(0,f.Z)(t,1)),(0,S.Z)((0,D.Z)(t,1),e.start)})[0];if(s){let e=0;if(s.reservations.forEach(t=>e+=t.customer_forms.length),e>=s.max_reservations)return null}(0,j.Z)(r[0])?r=[r[0],(0,p.Z)(r[0],1)]:(0,b.Z)(r[0])&&(r=[r[0],(0,f.Z)(r[0],1)]);let l=[];if(r.length>1?(E(!1),l=(l=a.filter(e=>0!==(0,u.Z)(e,r[0]))).filter(e=>0!==(0,u.Z)(e,r[1]))):(E(!1),l=a.filter(e=>0!==(0,u.Z)(e,r[0]))),l.length===a.length){if(a.length+r.length>z)return E(!0),null;n(e=>e.concat(r))}else n(l)},P=e=>{(0,Z.Z)(e,(0,g.Z)(new Date,1))||(0,y.Z)(e,(0,v.Z)(new Date,3))||C(e)},G=e=>{if(k.includes(e.getMonth())&&!(0,y.Z)(e,(0,f.Z)(new Date,1))){if("regatta"===i.value&&!q.includes(e.getDay()))return{style:{background:"#e6e6e6"}};let t=a.every(t=>0!==(0,u.Z)(t,e));return{style:{background:t?"":"#C1E1C1",cursor:"pointer"}}}return{style:{background:"#e6e6e6"}}},W=()=>({style:{zIndex:-1,pointerEvents:"none",textAlign:"-webkit-center",borderRadius:0}});return(0,r.jsx)(d.W2,{className:"mt-4",children:(0,r.jsx)(c.f,{events:t,localizer:H,style:{height:500},culture:I.locale,views:["month"],selectable:!0,onSelectSlot:J,dayPropGetter:G,eventPropGetter:W,components:F,onNavigate:P,date:B,messages:L,formats:X})})},I={beginner_skipper:{value:"beginner_skipper",label:"beginner_skipper_label",days:4},intermediate_skipper:{value:"intermediate_skipper",label:"intermediate_skipper_label",days:7},initiation_sailing:{value:"initiation_sailing",label:"initiation_sailing_label",days:2},regatta:{value:"regatta",label:"regatta_label",days:5}};I.beginner_skipper.value,I.initiation_sailing.value;var M=a(23855),B=a(43472),C=a(74231),z=a(95570),R=a(94184),L=a.n(R);let X=e=>{let{field:t,fieldLabel:a,errors:s,touched:l,required:n,setFieldValue:i,children:o,formGroupClasses:c,onSelect:h}=e;return(0,r.jsxs)(d.cw,{row:!0,className:c,children:[(0,r.jsxs)(d.__,{for:t,lg:2,children:[a,n&&(0,r.jsx)("span",{className:"required-asterisk",children:"*"})]}),(0,r.jsxs)(d.JX,{lg:10,children:[(0,r.jsx)(d.BZ,{children:(0,r.jsx)(d.II,{type:"select",name:t,id:t,onChange:e=>h?h(e):i(t,e.target.value),required:!0,className:L()({"is-invalid":l[t]&&s[t]}),children:o})}),(0,r.jsx)(B.Bc,{name:t,render:e=>(0,r.jsx)("small",{className:"text-danger",children:e})})]})]})};var O=a(70297),F=a(82625),A=a(37054);let H=["places"],J=e=>{let{field:t,fieldLabel:a,errors:s,touched:l,required:n,formGroupClasses:i,onSelect:o,options:c}=e,{isLoaded:h}=(0,A.Db)({googleMapsApiKey:"AIzaSyDqmAZBN1UdBwWUf33tX-XB1WDUw8jwL_E",libraries:H});return h&&(0,r.jsxs)(d.cw,{row:!0,className:i,children:[(0,r.jsxs)(d.__,{for:t,lg:2,children:[a,n&&(0,r.jsx)("span",{className:"required-asterisk",children:"*"})]}),(0,r.jsxs)(d.JX,{lg:10,children:[(0,r.jsx)(d.BZ,{children:(0,r.jsx)(F.default,{apiKey:"AIzaSyDqmAZBN1UdBwWUf33tX-XB1WDUw8jwL_E",onPlaceSelected:o,options:c,className:L()("form-control",{"is-invalid":l[t]&&s[t]})})}),(0,r.jsx)(B.Bc,{name:t,render:e=>(0,r.jsx)("small",{className:"text-danger",children:e})})]})]})};var P=a(93607);let G=e=>{let{field:t,dayField:a,monthField:s,yearField:l,fieldLabel:n,dayPlaceholder:i,monthPlaceholder:o,yearPlaceholder:c,errors:h,touched:u,required:m}=e;return(0,r.jsxs)(d.cw,{row:!0,children:[(0,r.jsxs)(d.__,{for:t,lg:2,children:[n,m&&(0,r.jsx)("span",{className:"required-asterisk",children:"*"})]}),(0,r.jsxs)(d.JX,{lg:5,className:"d-flex",children:[(0,r.jsxs)("div",{className:"me-2",children:[(0,r.jsx)(d.II,{type:"number",name:a,id:a,tag:B.gN,required:!0,className:L()({"is-invalid":u[a]&&h[a]}),placeholder:i}),(0,r.jsx)(B.Bc,{name:a,render:e=>(0,r.jsx)("small",{className:"text-danger",children:e})})]}),(0,r.jsxs)("div",{className:"me-2",children:[(0,r.jsx)(d.II,{type:"number",name:s,id:s,tag:B.gN,required:!0,className:L()({"is-invalid":u[s]&&h[s]}),placeholder:o}),(0,r.jsx)(B.Bc,{name:s,render:e=>(0,r.jsx)("small",{className:"text-danger",children:e})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.II,{type:"number",name:l,id:l,tag:B.gN,required:!0,className:L()({"is-invalid":u[l]&&h[l]}),placeholder:c}),(0,r.jsx)(B.Bc,{name:l,render:e=>(0,r.jsx)("small",{className:"text-danger",children:e})})]})]})]})},W=e=>{let{field:t,fieldLabel:a,errors:s,touched:l,required:n,labelClasses:i}=e;return(0,r.jsxs)(d.cw,{row:!0,className:"align-items-center",children:[(0,r.jsxs)(d.__,{className:"d-flex",for:t,lg:11,children:[(0,r.jsx)("div",{className:i,children:a}),n&&(0,r.jsx)("span",{className:"required-asterisk",children:"*"})]}),(0,r.jsx)(d.JX,{lg:1,children:(0,r.jsx)(d.BZ,{children:(0,r.jsx)(d.II,{type:"checkbox",name:t,id:t,tag:B.gN,required:!0,className:L()({"is-invalid":l[t]&&s[t]})})})}),(0,r.jsx)(B.Bc,{name:t,render:e=>(0,r.jsx)("small",{className:"text-danger",children:e})})]})},U=e=>{let{field:t,fieldLabel:a,errors:s,touched:l,required:n,labelClasses:i,labelRole:o,labelOnClick:c}=e;return(0,r.jsxs)(d.cw,{row:!0,className:"align-items-center",children:[(0,r.jsxs)(d.__,{className:"d-flex",for:t,lg:11,children:[(0,r.jsx)("div",{role:o,className:i,onClick:e=>{e.preventDefault(),c&&c()},children:a}),n&&(0,r.jsx)("span",{className:"required-asterisk",children:"*"})]}),(0,r.jsx)(d.JX,{lg:1,children:(0,r.jsx)(d.BZ,{children:(0,r.jsx)(d.II,{type:"checkbox",name:t,id:t,tag:B.gN,required:!0,className:L()({"is-invalid":l[t]&&s[t]})})})}),(0,r.jsx)(B.Bc,{name:t,render:e=>(0,r.jsx)("small",{className:"text-danger",children:e})})]})},T=e=>{let{eventsSelected:t,daysSelected:a,type:l,router:i,modalIsOpen:c,setModalIsOpen:u,isAdmin:m}=e,{t:_}=(0,o.$G)("reservationForm"),[x,f]=(0,s.useState)(1),[g,v]=(0,s.useState)(4),[y,Z]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(!m){let e=g;0===t.length?e=4:t.forEach(t=>{let a=0;t.reservations.forEach(e=>{a+=e.customer_forms.length});let r=t.max_reservations-a;e=r}),v(e)}},[t]);let N=(e,r)=>{let{resetForm:s}=r,d=a.map(e=>(0,D.Z)(e,1));0!==t.length&&a.forEach((e,a)=>{for(let r of t)((0,S.Z)((0,D.Z)(e,1),new Date(r.start))||(0,S.Z)((0,D.Z)(e,1),new Date(r.end)))&&delete d[a]});let o=d.filter(e=>e).filter(e=>!(0,b.Z)(e)).map(e=>(0,j.Z)(e)?{start:(0,h.Z)(new Date(e),"yyyy-MM-dd HH-mm-ss"),end:(0,h.Z)(new Date((0,p.Z)(e,1)),"yyyy-MM-dd HH-mm-ss")}:{start:(0,h.Z)(new Date(e),"yyyy-MM-dd HH-mm-ss"),end:(0,h.Z)(new Date(e),"yyyy-MM-dd HH-mm-ss")}),c=t.map(e=>e.id);e.forms.forEach(e=>{e.birthdate="".concat(e.birthdate.day.toString(),"/").concat(e.birthdate.month.toString(),"/").concat(e.birthdate.year.toString())});let u={...e,events:c,eventsDates:o,language:i.query.locale,type:l.value};m?n.If.store(u).then(()=>{s()}):n.Rz.createCheckoutSession(u).then(e=>{i.push(e.url)})},w=C.Ry().shape({forms:C.IX().of(C.Ry().shape({first_name:C.Z_().min(2,_("validation_too_short")).max(50,_("validation_too_long")).required(_("validation_required")),last_name:C.Z_().min(2,_("validation_too_short")).max(50,_("validation_too_long")).required(_("validation_required")),email:C.Z_().email(_("validation_email_invalid")).required(_("validation_required")),address:C.Z_().required(_("validation_required")),phone_number:C.Z_().matches(/^((\\+[1-9]{1,4}[ \\-]*)|(\\([0-9]{2,3}\\)[ \\-]*)|([0-9]{2,4})[ \\-]*)*?[0-9]{3,4}?[ \\-]*[0-9]{3,4}?$/,_("validation_phone_number_invalid")).required(_("validation_required")),birthdate:C.Ry().shape({day:C.Rx().min(1,_("validation_birthdate_day_too_low")).max(31,_("validation_birthdate_day_too_high")).required(_("validation_required")),month:C.Rx().min(1,_("validation_birthdate_month_too_low")).max(12,_("validation_birthdate_month_too_high")).required(_("validation_required")),year:1===x?C.Rx().min(1900,_("validation_birthdate_year_too_low")).max((0,z.Z)(new Date)-17,_("validation_birthdate_year_too_high")).required(_("validation_required")):C.Rx().min(1900,_("validation_birthdate_year_too_low")).required(_("validation_required"))}),terms_accepted:C.O7().oneOf([!0],_("validation_required"))}))}),k=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(O.Z,{field:"forms.".concat(a,".first_name"),fieldLabel:_("first_name_label"),placeholder:_("first_name_placeholder"),errors:e,touched:t,required:!0}),(0,r.jsx)(O.Z,{field:"forms.".concat(a,".last_name"),fieldLabel:_("last_name_label"),placeholder:_("last_name_placeholder"),errors:e,touched:t,required:!0}),(0,r.jsx)(O.Z,{field:"forms.".concat(a,".email"),fieldLabel:_("email_label"),placeholder:_("email_placeholder"),errors:e,touched:t,required:!0}),(0,r.jsx)(J,{field:"forms.".concat(a,".address"),fieldLabel:_("address_label"),placeholder:_("address_placeholder"),errors:e,touched:t,required:!0,onSelect:e=>s("forms.".concat(a,".address"),e.formatted_address),options:{componentRestrictions:{country:"CA"},types:["address"]}}),(0,r.jsx)(P.Z,{field:"forms.".concat(a,".phone_number"),fieldLabel:_("phone_number_label"),placeholder:_("phone_number_placeholder"),errors:e,touched:t,required:!0}),(0,r.jsx)(G,{field:"forms.".concat(a,".birthdate"),dayField:"forms.".concat(a,".birthdate.day"),monthField:"forms.".concat(a,".birthdate.month"),yearField:"forms.".concat(a,".birthdate.year"),fieldLabel:_("birthdate_label"),dayPlaceholder:_("day_placeholder"),monthPlaceholder:_("month_placeholder"),yearPlaceholder:_("year_placeholder"),errors:e,touched:t,required:!0}),(l.value===I.initiation_sailing.value||l.value===I.beginner_skipper.value)&&(0,r.jsx)(W,{field:"forms.".concat(a,".has_manual"),fieldLabel:_("has_manual_label"),errors:e,touched:t}),l.value!==I.regatta.value&&(0,r.jsx)(W,{field:"forms.".concat(a,".has_logbook"),fieldLabel:_("has_logbook_label"),errors:e,touched:t}),l.value!==I.regatta.value&&(0,r.jsx)(W,{field:"forms.".concat(a,".has_exam"),fieldLabel:_("has_exam_label"),errors:e,touched:t}),(0,r.jsx)(U,{field:"forms.".concat(a,".terms_accepted"),fieldLabel:_("terms_accepted_label"),labelClasses:"text-decoration-underline",labelOnClick:()=>Z(!0),labelRole:"button",errors:e,touched:t,required:!0})]})},q=(e,t,a,s)=>{let l=[],n=[],i=x;a.forms.length<i&&(i=a.forms.length);for(let o=0;o<a.forms.length;o++)a.forms.length>1&&l.push((0,r.jsx)(d.LY,{role:"button",children:(0,r.jsx)(d.OL,{className:"".concat(x===o+1?"active":""),onClick:()=>f(o+1),children:_("person_tab_name_".concat(o))})},o)),n.push((0,r.jsx)(d.I5,{activeTab:i,children:(0,r.jsx)(d.Jm,{tabId:o+1,children:k(e,t,o,s)})},o));return(0,r.jsxs)(r.Fragment,{children:[l.length>1&&(0,r.jsx)(d.JL,{tabs:!0,className:"mb-5",children:l}),n]})},E=e=>{u(e=>!e),e()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B.J9,{onSubmit:N,initialValues:{forms:[{first_name:"",last_name:"",email:"",address:"",phone_number:"",birthdate:{day:"",month:"",year:""},has_manual:!1,has_logbook:!1,has_exam:!1,terms_accepted:!1}],number_of_people:"1",type:"brevet_elementaire"},validationSchema:w,enableReinitialize:!0,children:e=>{let{isSubmitting:t,touched:a,errors:s,submitForm:l,setFieldValue:n,values:i,initialValues:o,resetForm:h}=e;return(0,r.jsxs)(d.u_,{isOpen:c,toggle:()=>E(h),size:"lg",children:[(0,r.jsx)(d.xB,{toggle:()=>E(h),children:_("registration")}),(0,r.jsx)(d.fe,{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B.l0,{children:(0,r.jsx)(B.F2,{name:"forms",render:e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(X,{field:"number_of_people",fieldLabel:_("number_of_people_label"),errors:s,touched:a,setFieldValue:n,required:!0,formGroupClasses:"mb-2",onSelect:t=>{if(t.target.value>i.number_of_people)for(let a=0;a<t.target.value-i.number_of_people;a++)e.push(o.forms[0]);else if(t.target.value<i.number_of_people)for(let a=0;a<i.number_of_people-t.target.value;a++)e.pop("");n("number_of_people",t.target.value)},children:[(0,r.jsx)("option",{disabled:g<1,children:"1"}),(0,r.jsx)("option",{disabled:g<2,children:"2"}),(0,r.jsx)("option",{disabled:g<3,children:"3"}),(0,r.jsx)("option",{disabled:g<4,children:"4"})]}),q(s,a,i,n)]})})}),t&&(0,r.jsx)("div",{className:"h-100 w-100 bg-light bg-opacity-10 mt-3",children:(0,r.jsx)("div",{className:"spinner-border",role:"status text-center"})})]})}),(0,r.jsxs)(d.mz,{children:[(0,r.jsx)(d.zx,{color:"primary",className:"me-2",disabled:t,onClick:()=>{if(s.forms){for(let[e,t]of s.forms.entries())if(void 0!==t){f(e+1);break}}l()},children:_("book")}),(0,r.jsx)(d.zx,{color:"secondary",onClick:()=>E(h),children:_("cancel")})]})]})}}),(0,r.jsxs)(d.u_,{centered:!0,isOpen:y,toggle:()=>Z(e=>!e),size:"lg",children:[(0,r.jsx)(d.xB,{toggle:()=>Z(e=>!e),children:_("terms__accepted_label")}),(0,r.jsx)(d.fe,{className:"h4 my-3",children:_("terms_accepted_description")})]})]})},$=(e,t,a)=>{let r=[];e.forEach(e=>{t.forEach(t=>{((0,S.Z)((0,D.Z)(e,1),new Date(t.start))||(0,S.Z)((0,D.Z)(e,1),new Date(t.end)))&&r.push(t)})}),a(r.filter((e,t,a)=>a.findIndex(t=>t.id===e.id)===t))},K=(e,t)=>((null==t?void 0:t.value)!=="beginner_skipper"||4!==e.length)&&((null==t?void 0:t.value)!=="initiation_sailing"||2!==e.length)&&((null==t?void 0:t.value)!=="regatta"||5!==e.length),V=(e,t)=>{e([]),t([])};var Y=a(39059),Q=a.n(Y);a.e(775).then(a.t.bind(a,36775,23));let ee=e=>{let{events:t,className:a,daysSelected:n,setDaysSelected:i,type:g}=e,v=(0,l.useRouter)(),{t:y}=(0,o.$G)("reservations"),[Z,k]=(0,s.useState)(null),[q,S]=(0,s.useState)(!1),[D,E]=(0,s.useState)(4),{messages:I,formats:M}=(0,s.useMemo)(()=>({messages:{previous:y("previous"),next:y("next"),today:y("today")},formats:{monthHeaderFormat:(e,t,a)=>{let r=a.format(e,"MMMM yyyy",t);return r.charAt(0).toUpperCase()+r.slice(1)}}}),[]);(0,s.useEffect)(()=>{(null==g?void 0:g.value)==="beginner_skipper"?E(4):(null==g?void 0:g.value)==="initiation_sailing"&&E(2),(null==g?void 0:g.value)==="regatta"&&E(5)},[g]);let B=e=>{let t=e.event,a=[];return t.reservations.forEach(e=>e.customer_forms.forEach(e=>a.push("".concat(e.first_name," ").concat(e.last_name)))),(0,r.jsx)("div",{className:"d-flex flex-column align-items-start",children:(0,r.jsx)("div",{className:"d-flex flex-wrap",children:a.map((e,t)=>(0,r.jsx)("div",{className:"me-2 ".concat(Q().eventCustomers),children:e},t))})})},C=(0,s.useMemo)(()=>({event:B}),[]),z={en:N.Z,fr:w.Z},R=(0,c.lD)({format:h.Z,parse:m.Z,startOfWeek:()=>(0,_.Z)(new Date,{weekStartsOn:1}),getDay:x.Z,locales:z}),L=()=>({style:{textAlign:"center"}}),X=e=>{let t=[e.slots[0]];(0,j.Z)(t[0])?t=[t[0],(0,p.Z)(t[0],1)]:(0,b.Z)(t[0])&&(t=[t[0],(0,f.Z)(t[0],1)]);let a=[];if((a=t.length>1?(a=n.filter(e=>0!==(0,u.Z)(e,t[0]))).filter(e=>0!==(0,u.Z)(e,t[1])):n.filter(e=>0!==(0,u.Z)(e,t[0]))).length===n.length){if(n.length+t.length>D)return null;i(e=>e.concat(t))}else i(a)},O=e=>{let t=n.every(t=>0!==(0,u.Z)(t,e));return{style:{background:t?"":"#C1E1C1"}}},F=()=>{S(e=>!e)};return(0,r.jsxs)(d.W2,{className:"mt-4",children:[(0,r.jsx)(c.f,{events:t,className:a,localizer:R,style:{height:500},culture:v.query.locale,views:["month"],selectable:!0,eventPropGetter:L,components:C,onSelectEvent:e=>{k(e),S(!0)},onSelectSlot:X,dayPropGetter:O,messages:I,formats:M}),Z&&(0,r.jsxs)(d.u_,{isOpen:q,toggle:F,size:"lg",children:[(0,r.jsx)(d.xB,{toggle:F,children:Z.title_en}),(0,r.jsx)(d.fe,{children:(0,r.jsx)(d.X2,{children:Z.reservations.map(e=>(0,r.jsxs)(d.JX,{children:[(0,r.jsx)("div",{children:e.type}),(0,r.jsx)(d.X2,{children:e.customer_forms.map(e=>{let{id:t,first_name:a,last_name:s,email:l,phone_number:n,address:i,birthdate:o}=e;return(0,r.jsxs)(d.JX,{children:[(0,r.jsx)("div",{children:a}),(0,r.jsx)("div",{children:s}),(0,r.jsx)("div",{children:l}),(0,r.jsx)("div",{children:n}),(0,r.jsx)("div",{children:i}),(0,r.jsx)("div",{children:o})]},t)})})]},e.id))})}),(0,r.jsx)(d.mz,{})]})]})};var et=a(4179);let ea=e=>{let{isAdmin:t}=e,a=(0,l.useRouter)(),{t:c}=(0,o.$G)("reservations"),[h,u]=(0,s.useState)([]),[m,_]=(0,s.useState)([]),[x,p]=(0,s.useState)([]),[f,g]=(0,s.useState)([]),[v,j]=(0,s.useState)(!1),[b,y]=(0,s.useState)(!1),[Z,N]=(0,s.useState)(!1),[w,k]=(0,s.useState)({value:I.beginner_skipper.value,label:c(I.beginner_skipper.label),days:I.beginner_skipper.days}),q=[{value:I.beginner_skipper.value,label:c(I.beginner_skipper.label),days:I.beginner_skipper.days},{value:I.initiation_sailing.value,label:c(I.initiation_sailing.label),days:I.initiation_sailing.days}];(0,s.useEffect)(()=>{var e;let t=null===(e=a.query)||void 0===e?void 0:e.type;t&&k(q.filter(e=>e.value===t)[0])},[a]),(0,s.useEffect)(()=>{let e=new URLSearchParams(window.location.search);e.get("success")&&N(!0),e.get("canceled")&&console.log("Order canceled -- continue to shop around and checkout when you’re ready.")},[]),(0,s.useEffect)(()=>{let e=t?n.If.index():n.If.eventsCalendar();e.then(e=>{let{data:t}=e;return p(t)})},[]),(0,s.useEffect)(()=>{if(x.length>0){let e=x.map(e=>({id:e.id,start:(0,M.Z)(e.start),end:(0,M.Z)(e.end),title_en:e.title_en,title_fr:e.title_fr,reservations:e.reservations,max_reservations:e.max_reservations}));g(e)}},[x]);let S=()=>{N(e=>!e),window.history.replaceState(null,"","/reservations")};return(0,r.jsxs)(d.W2,{className:"my-5",children:[(0,r.jsx)("h1",{className:"mb-4",children:c("page_title")}),(0,r.jsx)("div",{children:c("type")}),(0,r.jsx)(i.ZP,{name:"type",id:"type",instanceId:"type",options:q,onChange:e=>{k(e),V(u,_)},value:w,styles:{menu:e=>({...e,zIndex:1e3})}}),(0,r.jsxs)("ul",{className:"mt-4",children:[(0,r.jsx)("li",{children:c("helper_text_select_days",{count:w.days,days:w.days})}),(0,r.jsx)("li",{children:c("helper_text_join_or_create_event")}),(0,r.jsxs)("li",{children:[c("helper_text_contact_us_description_1"),(0,r.jsx)(et.Z,{href:"/contact-us",children:c("helper_text_contact_us_link")}),c("helper_text_contact_us_description_2")]}),(0,r.jsx)("li",{children:c("helper_text_available_months")}),b&&(0,r.jsx)("li",{className:"text-danger",children:c("helper_text_too_many_days_error")})]}),t?(0,r.jsx)(ee,{events:f,daysSelected:h,setDaysSelected:u,type:w}):(0,r.jsx)(E,{events:f,daysSelected:h,setDaysSelected:u,type:w,setTooManyDaysError:y}),(0,r.jsx)(d.zx,{color:"primary",className:"mt-5 w-100",disabled:K(h,w),onClick:()=>{j(e=>!e),$(h,x,_)},children:c("book_now")}),(0,r.jsx)(T,{daysSelected:h,eventsSelected:m,type:w,router:a,modalIsOpen:v,setModalIsOpen:j,isAdmin:t}),(0,r.jsxs)(d.u_,{centered:!0,isOpen:Z,toggle:S,size:"lg",children:[(0,r.jsx)(d.xB,{toggle:S,children:c("booking_success_title")}),(0,r.jsx)(d.fe,{className:"h4 my-3",children:c("booking_success_description")})]})]})};var er=a(94087),es=a(9008),el=a.n(es);let en=()=>{let e=(0,l.useRouter)(),{user:t}=(0,er.a)();return(0,s.useEffect)(()=>{t||e.push("/admin-login")},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(el(),{children:[(0,r.jsx)("title",{children:" Voile 4 vents admin reservations page "}),(0,r.jsx)("meta",{name:"description",content:"Look and change the reservations made by the clients"})]}),(0,r.jsx)(ea,{isAdmin:!0})]})};var ei=!0,ed=en},13125:function(e,t,a){"use strict";a.d(t,{H6:function(){return j},If:function(){return i},Ws:function(){return y},Rz:function(){return o},KH:function(){return _}});var r=a(46509);let s=()=>r.Z.get("/events").then(e=>e.data),l=()=>r.Z.get("/events/calendar").then(e=>e.data),n=e=>r.Z.post("/events",e).then(e=>e.data);var i={index:s,store:n,eventsCalendar:l};let d=e=>r.Z.post("/create-checkout-session",e).then(e=>e.data);var o={createCheckoutSession:d};let c=()=>r.Z.get("/todos").then(e=>e.data),h=e=>r.Z.post("/todos",e).then(e=>e.data),u=(e,t)=>r.Z.put("/todos/".concat(e),t).then(e=>e.data),m=e=>r.Z.delete("todos/".concat(e));var _={index:c,store:h,update:u,deleteTodo:m};let x=()=>r.Z.get("/allowed-skippers").then(e=>e.data),p=(e,t)=>r.Z.get("/allowed-skippers/datatable",{params:{page:e,per_page:t}}).then(e=>e.data),f=e=>r.Z.post("/allowed-skippers",e).then(e=>e.data),g=(e,t)=>r.Z.put("/allowed-skippers/".concat(e),t).then(e=>e.data),v=e=>r.Z.delete("allowed-skippers/".concat(e));var j={index:x,datatable:p,store:f,update:g,deleteTodo:v};let b=e=>r.Z.post("/mail/send-contact-us-email",e).then(e=>e.data);var y={sendContactUsEmail:b}},39059:function(e){e.exports={eventCustomers:"AdminCalendar_eventCustomers__khgzR"}}},function(e){e.O(0,[255,770,494,193,774,888,179],function(){return e(e.s=8810)}),_N_E=e.O()}]);